@model ModelLibrary.Device

<div class="history-container container my-4 p-3 bg-white rounded-4 shadow-sm border">
    <h5 class="fw-bold mb-3 text-primary">
        <i class="bi bi-clock-history me-2"></i> Lịch sử dữ liệu thiết bị
    </h5>

    <div class="row g-3 align-items-end mb-3">
        <input type="hidden" id="deviceId" value="@Model.id" />
        <input type="hidden" id="deviceType" value="@Model.type" />

        <div class="col-md-4">
            <label for="pickTime" class="form-label fw-semibold">Khoảng thời gian</label>
            <select class="form-select" id="pickTime">
                <option value="-1h" selected>1 giờ qua</option>
                <option value="-3h">3 giờ qua</option>
                <option value="-6h">6 giờ qua</option>
                <option value="-12h">12 giờ qua</option>
                <option value="-24h">24 giờ qua</option>
                <option value="-2d">2 ngày qua</option>
                <option value="-7d">7 ngày qua</option>
                <option value="-15d">15 ngày qua</option>
                <option value="-30d">30 ngày qua</option>
            </select>
        </div>

        @switch (Model.type)
        {
            case "AX01":
                <div class="col-md-5">
                    <label class="form-label fw-semibold">Loại dữ liệu</label>
                    <div class="d-flex flex-wrap gap-3">
                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="pickType" id="pickType1" value="TemHum" checked>
                            <label class="form-check-label" for="pickType1">Độ ẩm & Nhiệt độ</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="pickType" id="pickType2" value="Relay">
                            <label class="form-check-label" for="pickType2">Trạng thái Relay</label>
                        </div>
                    </div>
                </div>
                break;

            case "AX02":
                <div class="col-md-5">
                    <label class="form-label fw-semibold">Loại dữ liệu</label>
                    <div class="d-flex flex-wrap gap-3">
                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="pickType" id="pickType1" value="TemHum" checked>
                            <label class="form-check-label" for="pickType1">Độ ẩm & Nhiệt độ</label>
                        </div>
                    </div>
                </div>
                break;

            default:
                <h4>Không tìm thấy loại thiết bị</h4>
                break;
        }

        <div class="col-md-3 text-md-end text-center">
            <button class="btn btn-primary px-4 w-100" id="TaoBieuDo">
                <i class="bi bi-bar-chart-line me-1"></i> Tạo biểu đồ
            </button>
        </div>
    </div>

    <div class="row mb-3">
        <div class="col d-flex flex-wrap gap-2">

            <button class="btn btn-success" id="btnExportExcel">
                <i class="bi bi-file-earmark-excel"></i> Xuất Excel
            </button>

            <button class="btn btn-primary" id="btnExportCSV">
                <i class="bi bi-filetype-csv"></i> Xuất CSV
            </button>

            <button class="btn btn-danger" id="btnExportPDF">
                <i class="bi bi-file-earmark-pdf"></i> Xuất PDF
            </button>
            <button id="btnDownloadChart" class="btn btn-secondary">
                <i class="bi bi-download"></i> Tải biểu đồ
            </button>
        </div>
    </div>

    <div class="Khung-History">
        <div id="relayTableContainer"></div>

        <canvas id="historyChart" style="width:100%; height:400px; display:block;"></canvas>
    </div>
</div>
